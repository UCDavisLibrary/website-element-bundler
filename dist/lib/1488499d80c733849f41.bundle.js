(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{11:function(e,t,s){"use strict";var r=s(7),n=s(9);
/**
@license
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/
Object(n.a)({is:"iron-request",hostAttributes:{hidden:!0},properties:{xhr:{type:Object,notify:!0,readOnly:!0,value:function(){return new XMLHttpRequest}},response:{type:Object,notify:!0,readOnly:!0,value:function(){return null}},status:{type:Number,notify:!0,readOnly:!0,value:0},statusText:{type:String,notify:!0,readOnly:!0,value:""},completes:{type:Object,readOnly:!0,notify:!0,value:function(){return new Promise(function(e,t){this.resolveCompletes=e,this.rejectCompletes=t}.bind(this))}},progress:{type:Object,notify:!0,readOnly:!0,value:function(){return{}}},aborted:{type:Boolean,notify:!0,readOnly:!0,value:!1},errored:{type:Boolean,notify:!0,readOnly:!0,value:!1},timedOut:{type:Boolean,notify:!0,readOnly:!0,value:!1}},get succeeded(){if(this.errored||this.aborted||this.timedOut)return!1;var e=this.xhr.status||0;return 0===e||e>=200&&e<300},send:function(e){var t=this.xhr;if(t.readyState>0)return null;t.addEventListener("progress",function(e){this._setProgress({lengthComputable:e.lengthComputable,loaded:e.loaded,total:e.total}),this.fire("iron-request-progress-changed",{value:this.progress})}.bind(this)),t.addEventListener("error",function(t){this._setErrored(!0),this._updateStatus();var s=e.rejectWithRequest?{error:t,request:this}:t;this.rejectCompletes(s)}.bind(this)),t.addEventListener("timeout",function(t){this._setTimedOut(!0),this._updateStatus();var s=e.rejectWithRequest?{error:t,request:this}:t;this.rejectCompletes(s)}.bind(this)),t.addEventListener("abort",function(){this._setAborted(!0),this._updateStatus();var t=new Error("Request aborted."),s=e.rejectWithRequest?{error:t,request:this}:t;this.rejectCompletes(s)}.bind(this)),t.addEventListener("loadend",function(){if(this._updateStatus(),this._setResponse(this.parseResponse()),this.succeeded)this.resolveCompletes(this);else{var t=new Error("The request failed with status code: "+this.xhr.status),s=e.rejectWithRequest?{error:t,request:this}:t;this.rejectCompletes(s)}}.bind(this)),this.url=e.url;var s=!1!==e.async;t.open(e.method||"GET",e.url,s);var n={json:"application/json",text:"text/plain",html:"text/html",xml:"application/xml",arraybuffer:"application/octet-stream"}[e.handleAs],i=e.headers||Object.create(null),a=Object.create(null);for(var o in i)a[o.toLowerCase()]=i[o];if(i=a,n&&!i.accept&&(i.accept=n),Object.keys(i).forEach(function(e){/[A-Z]/.test(e)&&r.a._error("Headers must be lower case, got",e),t.setRequestHeader(e,i[e])},this),s){t.timeout=e.timeout;var l=e.handleAs;!e.jsonPrefix&&l||(l="text"),t.responseType=t._responseType=l,e.jsonPrefix&&(t._jsonPrefix=e.jsonPrefix)}t.withCredentials=!!e.withCredentials;var d=this._encodeBodyObject(e.body,i["content-type"]);return t.send(d),this.completes},parseResponse:function(){var e=this.xhr,t=e.responseType||e._responseType,s=!this.xhr.responseType,r=e._jsonPrefix&&e._jsonPrefix.length||0;try{switch(t){case"json":if(s||void 0===e.response)try{return JSON.parse(e.responseText)}catch(t){return console.warn("Failed to parse JSON sent from "+e.responseURL),null}return e.response;case"xml":return e.responseXML;case"blob":case"document":case"arraybuffer":return e.response;case"text":default:if(r)try{return JSON.parse(e.responseText.substring(r))}catch(t){return console.warn("Failed to parse JSON sent from "+e.responseURL),null}return e.responseText}}catch(e){this.rejectCompletes(new Error("Could not parse response. "+e.message))}},abort:function(){this._setAborted(!0),this.xhr.abort()},_encodeBodyObject:function(e,t){if("string"==typeof e)return e;var s=e;switch(t){case"application/json":return JSON.stringify(s);case"application/x-www-form-urlencoded":return this._wwwFormUrlEncode(s)}return e},_wwwFormUrlEncode:function(e){if(!e)return"";var t=[];return Object.keys(e).forEach(function(s){t.push(this._wwwFormUrlEncodePiece(s)+"="+this._wwwFormUrlEncodePiece(e[s]))},this),t.join("&")},_wwwFormUrlEncodePiece:function(e){return null!==e&&void 0!==e&&e.toString?encodeURIComponent(e.toString().replace(/\r?\n/g,"\r\n")).replace(/%20/g,"+"):""},_updateStatus:function(){this._setStatus(this.xhr.status),this._setStatusText(void 0===this.xhr.statusText?"":this.xhr.statusText)}}),
/**
@license
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/
Object(n.a)({is:"iron-ajax",hostAttributes:{hidden:!0},properties:{url:{type:String},params:{type:Object,value:function(){return{}}},method:{type:String,value:"GET"},headers:{type:Object,value:function(){return{}}},contentType:{type:String,value:null},body:{type:Object,value:null},sync:{type:Boolean,value:!1},handleAs:{type:String,value:"json"},withCredentials:{type:Boolean,value:!1},timeout:{type:Number,value:0},auto:{type:Boolean,value:!1},verbose:{type:Boolean,value:!1},lastRequest:{type:Object,notify:!0,readOnly:!0},lastProgress:{type:Object,notify:!0,readOnly:!0},loading:{type:Boolean,notify:!0,readOnly:!0},lastResponse:{type:Object,notify:!0,readOnly:!0},lastError:{type:Object,notify:!0,readOnly:!0},activeRequests:{type:Array,notify:!0,readOnly:!0,value:function(){return[]}},debounceDuration:{type:Number,value:0,notify:!0},jsonPrefix:{type:String,value:""},bubbles:{type:Boolean,value:!1},rejectWithRequest:{type:Boolean,value:!1},_boundHandleResponse:{type:Function,value:function(){return this._handleResponse.bind(this)}}},observers:["_requestOptionsChanged(url, method, params.*, headers, contentType, body, sync, handleAs, jsonPrefix, withCredentials, timeout, auto)"],created:function(){this._boundOnProgressChanged=this._onProgressChanged.bind(this)},get queryString(){var e,t,s=[];for(e in this.params)if(t=this.params[e],e=window.encodeURIComponent(e),Array.isArray(t))for(var r=0;r<t.length;r++)s.push(e+"="+window.encodeURIComponent(t[r]));else null!==t?s.push(e+"="+window.encodeURIComponent(t)):s.push(e);return s.join("&")},get requestUrl(){var e=this.queryString,t=this.url||"";return e?t+(t.indexOf("?")>=0?"&":"?")+e:t},get requestHeaders(){var e,t={},s=this.contentType;if(null==s&&"string"==typeof this.body&&(s="application/x-www-form-urlencoded"),s&&(t["content-type"]=s),"object"==typeof this.headers)for(e in this.headers)t[e]=this.headers[e].toString();return t},_onProgressChanged:function(e){this._setLastProgress(e.detail.value)},toRequestOptions:function(){return{url:this.requestUrl||"",method:this.method,headers:this.requestHeaders,body:this.body,async:!this.sync,handleAs:this.handleAs,jsonPrefix:this.jsonPrefix,withCredentials:this.withCredentials,timeout:this.timeout,rejectWithRequest:this.rejectWithRequest}},generateRequest:function(){var e=document.createElement("iron-request"),t=this.toRequestOptions();return this.push("activeRequests",e),e.completes.then(this._boundHandleResponse).catch(this._handleError.bind(this,e)).then(this._discardRequest.bind(this,e)),this.fire("iron-ajax-presend",{request:e,options:t},{bubbles:this.bubbles,cancelable:!0}).defaultPrevented?(e.abort(),e.rejectCompletes(e),e):(this.lastRequest&&this.lastRequest.removeEventListener("iron-request-progress-changed",this._boundOnProgressChanged),e.addEventListener("iron-request-progress-changed",this._boundOnProgressChanged),e.send(t),this._setLastProgress(null),this._setLastRequest(e),this._setLoading(!0),this.fire("request",{request:e,options:t},{bubbles:this.bubbles,composed:!0}),this.fire("iron-ajax-request",{request:e,options:t},{bubbles:this.bubbles,composed:!0}),e)},_handleResponse:function(e){e===this.lastRequest&&(this._setLastResponse(e.response),this._setLastError(null),this._setLoading(!1)),this.fire("response",e,{bubbles:this.bubbles,composed:!0}),this.fire("iron-ajax-response",e,{bubbles:this.bubbles,composed:!0})},_handleError:function(e,t){this.verbose&&r.a._error(t),e===this.lastRequest&&(this._setLastError({request:e,error:t,status:e.xhr.status,statusText:e.xhr.statusText,response:e.xhr.response}),this._setLastResponse(null),this._setLoading(!1)),this.fire("iron-ajax-error",{request:e,error:t},{bubbles:this.bubbles,composed:!0}),this.fire("error",{request:e,error:t},{bubbles:this.bubbles,composed:!0})},_discardRequest:function(e){var t=this.activeRequests.indexOf(e);t>-1&&this.splice("activeRequests",t,1)},_requestOptionsChanged:function(){this.debounce("generate-request",function(){null!=this.url&&this.auto&&this.generateRequest()},this.debounceDuration)}})},2:function(e,t,s){"use strict";s.r(t);var r=s(6);s(17),s(25),s(11);const n=document.createElement("template");n.innerHTML="\n<style>\nlibrary-hours {\n  display: block;\n  background-color: transparent;\n  padding: 0px;\n}\n\nlibrary-hours .hours-table{\n    border-bottom: none;\n    border-collapse: collapse;\n    margin-bottom: 0px;\n    width: 100%;\n    display: table;\n    table-layout: fixed;\n}\n\nlibrary-hours .hours-tr {\n    background-color: transparent;\n    border: none;\n    display:table-row;\n}\n\nlibrary-hours .hours-td {\n    border-bottom: none;\n    border-top: 1px solid #d8d8d8;\n    padding-left: 0px;\n    padding-right: 0px;\n    padding-bottom: 8px;\n    padding-top: 8px;\n    word-wrap: normal;\n    display: table-cell;\n    vertical-align: middle;\n}\n\n\nlibrary-hours a {\n    color: #002655;\n}\n\nlibrary-hours .closed {\n    color:#ba0c2f;\n    text-align: center;\n    font-weight: 600;\n    width: 11%;\n}\nlibrary-hours .open {\n    text-align: center;\n    width: 11%;\n}\n\nlibrary-hours th.is-today{\n    border-top: 3px solid #DAAA00;\n}\n\nlibrary-hours .keep-together{\n    white-space: nowrap;\n}\nlibrary-hours .status-icon{\n    margin-right: 4px;\n    margin-left: 8px;\n    margin-bottom: inherit !important;\n    width: 25px;\n    height: 25px;\n    min-width: 25px;\n    min-height: 25px;\n}\n  library-hours .lib-titles{\n      display:flex;\n      align-items:center;\n      font-weight: 600;\n      text-decoration: none;\n\n  }\n  library-hours .dept-titles{\n      display:flex;\n      align-items:center;\n  }\n</style>",document.head.appendChild(n.content);var i=e=>(class extends e{_attachDom(e){if(window.ShadyDOM&&window.ShadyDOM.inUse)return super._attachDom(e);let t=e.querySelectorAll("style");for(var s=0;s<t.length;s++)t[s].parentNode.removeChild(t[s]),this._stylesInserted||(t[s].setAttribute("id",this.nodeName.toLowerCase()+"-styles"),document.head.appendChild(t[s]));return this.appendChild(e),e}querySelector(e){return this.shadowRoot?this.shadowRoot.querySelector(e):super.querySelector(e)}querySelectorAll(e){return this.shadowRoot?this.shadowRoot.querySelectorAll(e):super.querySelectorAll(e)}});class a extends(Mixin(r.a).with(i)){static get template(){return r["b"]`
        <iron-ajax
            id="init_ajax"
            url$="[[json_path]]"
            handle-as="json"
            on-response="_make_iron_ajax"
            debounce-duration="300"></iron-ajax>


    <template id="ajax_repeater" is="dom-repeat" items={{_api_parameters}} as="api">
    <iron-ajax
        id="[[api.id]]"
        url="[[api.url]]"
        params="[[api.params]]"
        handle-as="json"
        on-response="handle_response"
        debounce-duration="300"></iron-ajax>
    </template>

        <div>
            <div class="link-see-all-top clearfix">
                <div class="float-xs-left">
                    <h2 style="padding-right:5px;">Library Hours Today</h2>
                </div>
                <div class="float-xs-right" style="margin-top:8px;">
                    <a href$="[[see_all]]" class="bold-link">See All
                        <i class="cork-chevron right small gold" style="vertical-align: text-bottom;"></i>
                    </a>
                </div>
            </div>
            <div class="spacer"></div>
        </div>

        <div class="hours-table">
            <template is="dom-repeat" items="{{hours_today}}" sort=sort_hours>
                <div class="hours-tr">
                    <div class="hours-td" style="width:59%;">
                        <a class$="[[item.type]]" href$=[[item.url]]>
                        <img  class="status-icon" src$=[[item.icon_url]] alt$=[[item.status]]>
                        [[item.title]]
                        </a>
                    </div>
                    <div class$="[[item.status]] hours-td" style="width:41%;">
                        <span class="keep-together">[[item.display_string.open]]</span>
                        <span class="keep-together">[[item.display_string.close]]</span>
                    </div>
                </div>
            </template>
            <div class="hours-tr">
                <div class="hours-td" style="width:59%;">
                    <a class="lib-titles" href="https://law.ucdavis.edu/library/about/hours-calendar.html">
                    <img  class="status-icon" src$="[[icon_dir]]link.svg" alt="hours">
                    Mabie Law
                    </a>
                </div>
                <div class="open hours-td" style="width:41%;">
                    <a class$="lib-titles" href="https://law.ucdavis.edu/library/about/hours-calendar.html">
                    Mabie Hours Site
                    </a>
                </div>
            </div>
        </div>

        `}static get is(){return"library-hours"}static get properties(){return{_calendars:{type:Object,value:{}},_api_parameters:{type:Array,value:[]},json_path:{type:String},see_all:{type:String,value:""},verbose:{type:Boolean},hours_today:{type:Array,value:[]},today:{type:Date},ajax_ids:{type:Array,value:[]},event_ids:{type:Array,value:[]},icon_dir:{type:String,value:""},_lib_event_crosswalk:{type:Object,value:{}}}}constructor(){super()}ready(){super.ready();try{var e=(new Date).toLocaleString("en-US",{timeZone:"America/Los_Angeles"});e=new Date(e.split(",")[0]),this.today=e}catch(t){e=this._ie_today(),this.today=e}String.prototype.includes||(String.prototype.includes=function(e,t){return"number"!=typeof t&&(t=0),!(t+e.length>this.length)&&-1!==this.indexOf(e,t)}),this.$.init_ajax.generateRequest()}_make_iron_ajax(e){for(var t=e.detail.response,s=0;s<t.length;s++){var r={};this.push("ajax_ids",t[s].ajax_id),r.url=t[s].url,r.params=t[s].params,r.params.singleEvents=!0;var n=this.today.toJSON().split("T")[0]+"T22:00:00-07:00";r.params.timeMax=n;var i=this.today.toJSON().split("T")[0]+"T02:00:00-07:00";r.params.timeMin=i,r.id=t[s].ajax_id,this._lib_event_crosswalk[t[s].ajax_id]=t[s].event_series;for(var a=0;a<t[s].event_series.length;a++)this.push("event_ids",t[s].event_series[a].search_term);this.push("_api_parameters",r)}this.verbose&&console.log("api parameters",this._api_parameters),this.$.ajax_repeater.render();for(s=0;s<this.ajax_ids.length;s++)this.querySelector("#"+this.ajax_ids[s]).generateRequest()}handle_response(e){var t=e.detail.response;this.verbose&&console.log("raw response",t);for(var s=e.target.getAttribute("id"),r=this._lib_event_crosswalk[s],n=0;n<r.length;n++){var i=r[n].search_term,a=r[n].title,o=r[n].type,l=r[n].url,d=this._parse_calendar(t,i),u={title:a,id:i,data:d,ajax_id:s,type:o,url:l};this._calendars[i]=u,this.verbose&&console.log(i," parsed",u);var h=d;if(h.display_string=this._hours_string(h),h.title=a,h.id=i,h.url=l,"library"==u.type.toLowerCase()){var p=!0;h.type="lib-titles"}else{p=!1;h.type="dept-titles"}p?this._open_now(h)?h.icon_url=this.icon_dir+"open-lib.svg":h.icon_url=this.icon_dir+"closed-lib.svg":this._open_now(h)?h.icon_url=this.icon_dir+"open-dept.svg":h.icon_url=this.icon_dir+"closed-dept.svg";var c=this.event_ids.indexOf(i);-1!=c&&(h.display_order=c,this.push("hours_today",h),this.verbose&&console.log(i," todays hours",h))}}_concat_id(e,t){return e+"__"+t}_open_now(e){if("closed"==e.status)return!1;try{var t=(s=(new Date).toLocaleString("en-GB",{timeZone:"America/Los_Angeles"})).split(",")[1].split(":");t=parseInt(t[0]+t[1])}catch(e){var s=this._ie_today(),r=String(s.getHours());1==r.length&&(r="0"+r);var n=String(s.getMinutes());1==n.length&&(n="0"+n);t=parseInt(r+n)}var i=e.start_time.split(":");i=parseInt(i[0]+i[1]);var a=e.end_time.split(":");return a=parseInt(a[0]+a[1]),t>=i&&t<a||t>=i&&i>=a}_format_header(e){var t="";return 7==e.length&&(t+=e[0].month_str.toUpperCase()+" "+e[0].day,t+=" - "+e[6].month_str.toUpperCase()+" "+e[6].day+" "+e[6].year),t}sort_hours(e,t){return e.display_order-t.display_order}_hours_string(e){if("closed"==e.status)return{open:"CLOSED",close:""};for(var t={},s=[e.start_time,e.end_time],r=0;r<2;r++){var n="",i=s[r].split(":"),a=parseInt(i[0]);if(a>12){a-=12;var o="pm"}else if(0==a){a=12;o="am"}else if(12==a){a=12;o="pm"}else o="am";n+=a.toString()+":"+i[1],n+=" "+o,0==r?t.open=n+" -":t.close=n}return t}split_datetime(e){var t={},s=e.split("T");s[0].split("-");return t.date=new Date(s[0]),t.time=s[1].substr(0,5),t}_ie_today(){for(var e=new Date,t=e.getTime()+6e4*e.getTimezoneOffset(),s=new Date(t+-252e5),r=new Date(t+-288e5),n=[new Date(2015,2,8),new Date(2015,10,2),new Date(2016,2,13),new Date(2016,10,7),new Date(2017,2,12),new Date(2017,10,6),new Date(2018,2,11),new Date(2018,10,5),new Date(2019,2,10),new Date(2019,10,4),new Date(2020,2,8),new Date(2020,10,2),new Date(2021,2,14),new Date(2021,10,8),new Date(2022,2,13),new Date(2022,10,7),new Date(2023,2,12),new Date(2023,10,6),new Date(2024,2,10),new Date(2024,10,4)],i=0;i<n.length;i++)if(r<n[i])return s;return console.log("Unable to determine daylight savings time. See _ie_today function"),e}_parse_calendar(e,t){for(var s=e.items,r={id:t,status:"closed"},n=0;n<s.length;n++){if("description"in s[n])var i=s[n].description.toLowerCase();else i="";if(i.includes(t.toLowerCase())){if(!0,"dateTime"in s[n].start){var a=this.split_datetime(s[n].start.dateTime);r.start_date=a.date,r.start_time=a.time,r.end_time=this.split_datetime(s[n].end.dateTime).time}else r.start_date=new Date(this.today),r.start_time="00:00",r.end_time="00:00";r.status="open";break}}return r}}customElements.define(a.is,a)}}]);